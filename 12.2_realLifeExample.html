<!DOCTYPE html>
<script>
    'use strict'

    // We should make a request to URL in the form https://api.github.com/repos/<repo>/commits.
    // It responds with a JSON of 30 commits, and also provide a link to the next page in the link header
    // Then we can use that link for the next request, to get more commits, and so on.

    async function* fetchCommits(repo) {
        let url = `https://api.github.com/repos/${repo}/commits`;

        while (url) {

            // We use the browser fetch method to download from a remote URL.
            // It allows us to supply authorization and other headers if needed
            // here Github requires User-Agent.
            const response = await fetch(url, {
                headers: {'User-Agent': 'Our script'},
            });

            // The fetch result is parsed as JSON.
            const body = await response.json();

            // We get the next page URL from the Link header of the response.
            // It has a special form so we use a regexp for that
            // The next page URL may look like https://api.github.com/repositories/93253246/commits?page=2
            // Itâ€™s generated by GitHub itself.
            let nextPage = response.headers.get('Link').match(/<(.*?)>; rel="next"/);
            nextPage = nextPage?.[1];

            url = nextPage;

            for ( let commit of body ) {
                yield commit;
            }

            // Then we yield all commits received, and when they finish, 
            // the next while(url) iteration will trigger, making one more request.
        }
    }

    ( async () => {
        let count = 0;

        for await ( const commit of fetchCommits('javascript-tutorial/en.javascript.info') ) {
            console.log(commit.author.login);
            if (++count == 100) {
                break;
            }
        }
    })();

</script>